<!--
  ~ Copyright 2018, TeamDev Ltd. All rights reserved.
  ~
  ~ Redistribution and use in source and/or binary forms, with or without
  ~ modification, must retain the above copyright notice and the following
  ~ disclaimer.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  ~ "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  ~ LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
  ~ A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
  ~ OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  ~ SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  ~ LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  ~ DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  ~ THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  ~ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  ~ OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->

<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import"
      href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">
<link rel="import"
      href="../../bower_components/paper-dialog-behavior/paper-dialog-shared-styles.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="./book_values.html">
<link rel="import" href="exlibris-book-details-form.html">
<link rel="import" href="exlibris-book-inventory-table.html">


<dom-module id="exlibris-wizard-dialog">
    <template>
        <style>
            :host {
                display: block;
                position: center;
            }

            #dialog {
                @apply --layout-vertical;;
                height: 650px;
                width: 950px;
            }

            #content {
                @apply --layout-horizontal;
                height: 90%;
                margin-top: 0;
                padding: 0;
            }

            #navigator {
                @apply --layout-horizontal;
                background-color: var(--app-primary-color);
                height: 10%;
                margin-top: 0;
                margin-bottom: 0;
                padding: 0;
            }

            #drawer {
                @apply --layout-vertical;
                width: 25%;
            }

            #toolbar {
                height: 20%;
                border-bottom: 1px solid var(--paper-grey-300);
            }

            #title {
                margin-top: 40px;
                margin-left: 35px;
                font-size: 17px;
            }

            #menu {
                height: 80%;
            }

            #page {
                width: 75%;
                border-left: 1px solid var(--paper-grey-300);
            }

            #cancel-button {
                color: white;
                margin: auto 20px;
                cursor: pointer;
                font-size: 12px;
                cursor: pointer;
            }

            #close-button {
                position: absolute;
                right: 4px;
                top: 4px;
                padding: 0;
                margin: 0;
            }

            #next-button {
                font-size: 12px;
                margin-left: 48%;
                margin-top: 5px;
                cursor: pointer;
            }

            #previous-button {
                margin-left: 20%;
                width: 65.14px;
                margin-top: 5px;
                cursor: pointer;
            }

            .next-text {
                color: white;
                font-size: 12px;
            }

            .arrow-icon {
                --iron-icon-fill-color: white;
                --iron-icon-width: 16px;
                --iron-icon-height: 16px;
            }

            #previous-label {
                font-size: 10px;
                margin-left: 19px;
                margin-bottom: -6px;
            }

            #next-label {
                font-size: 10px;
                margin-bottom: -6px;
            }

            iron-icon {
                --iron-icon-fill-color: var(--app-secondary-color);
            }


        </style>

        <paper-dialog id="dialog">

            <div id="content">

                <div id="close-button">
                    <paper-icon-button icon="close" on-tap="close"
                                       style="color:var(--app-secondary-color)"></paper-icon-button>
                </div>

                <div id="drawer">
                    <div id="toolbar">
                        <div id="title">Add Book</div>
                    </div>
                    <div id="menu">
                        <iron-selector attr-for-selected="data-name"
                                       selected="{{page}}"
                                       on-selected-item-changed="_getSelectedTitle">

                            <menu-item data-name="details"
                                       title="Details"
                                       link="/details"
                                       on-menu-item-click="_changeRoute">
                                <iron-icon icon="radio-button-unchecked"
                                           slot="icon"></iron-icon>
                            </menu-item>

                            <menu-item data-name="inventory"
                                       title="Inventory"
                                       link="/inventory"
                                       on-menu-item-click="_changeRoute">
                                <iron-icon icon="av:library-books"
                                           slot="icon"></iron-icon>
                            </menu-item>
                        </iron-selector>
                    </div>
                </div>
                <div id="page">

                    <iron-pages
                            selected="[[page]]"
                            attr-for-selected="data-name">
                        <exlibris-book-details-form
                                data-name="details"></exlibris-book-details-form>
                        <div data-name="inventory">
                            <exlibris-book-inventory-table></exlibris-book-inventory-table>
                        </div>
                    </iron-pages>

                </div>
            </div>
            <div id="navigator">

                <div id="cancel-button" on-tap="close">CANCEL</div>
                <div id="previous-button">

                    <template is="dom-if" if="[[!_isDetails(page)]]">
                        <div id="previous-label" on-tap="_changePage">PREVIOUS</div>
                        <iron-icon class="arrow-icon" icon="arrow-back"
                                   slot="icon"></iron-icon>
                        <span class="next-text">DETAIL</span>
                    </template>
                </div>
                <div id="next-button" on-tap="_changePage">
                    <div id="next-label">NEXT</div>
                    <template is="dom-if" if="[[_isDetails(page)]]">
                        <span class="next-text">INVENTORY</span>
                    </template>
                    <template is="dom-if" if="[[!_isDetails(page)]]">
                        <span class="next-text" on-tap="_handleFinish"> FINISH</span>
                    </template>
                    <iron-icon class="arrow-icon" icon="arrow-forward"
                               slot="icon"></iron-icon>
                </div>

            </div>
        </paper-dialog>

    </template>

    <script>

        class ExlibrisWizardDialog extends Polymer.Element {
            static get is() {
                return 'exlibris-wizard-dialog';
            }

            static get properties() {
                return {
                    page: {
                        type: String,
                        value: 'details'
                    },
                };
            }

            /**
             * Opens the modal dialog.
             */
            open() {
                this.$.dialog.open();
                console.log(12);
            }

            /**
             * Closes the modal dialog.
             */
            close() {
                this.$.dialog.close();
            }

            _isDetails() {
                if (this.page === 'details') {
                    return true;
                }
                return false;
            }

            _changePage() {
                if (this.page === "details") {
                    this.page = "inventory";
                    return;
                }
                this.page = "details";
            }


            _handleFinish() {
                this.dispatchEvent(new CustomEvent("input-finished"));
                console.log("Input was finished")
            }
        }

        window.customElements.define(ExlibrisWizardDialog.is, ExlibrisWizardDialog);
    </script>
</dom-module>
